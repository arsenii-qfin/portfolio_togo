import pandas as pd
import plotly.express as px
import numpy as np


portfolio_data={'AAPL': {'units': 4, 'data': [{'Date': '2025-04-28', 'Close': 209.8647918701172}, {'Date': '2025-04-29', 'Close': 210.9333953857422}, {'Date': '2025-04-30', 'Close': 212.22171020507812}, {'Date': '2025-05-01', 'Close': 213.04063415527344}, {'Date': '2025-05-02', 'Close': 205.08106994628906}, {'Date': '2025-05-05', 'Close': 198.62953186035156}, {'Date': '2025-05-06', 'Close': 198.25001525878906}, {'Date': '2025-05-07', 'Close': 195.99298095703125}, {'Date': '2025-05-08', 'Close': 197.2313690185547}, {'Date': '2025-05-09', 'Close': 198.27000427246094}, {'Date': '2025-05-12', 'Close': 210.7899932861328}, 
                                              {'Date': '2025-05-13', 'Close': 212.92999267578125}, {'Date': '2025-05-14', 'Close': 212.3300018310547}, {'Date': '2025-05-15', 'Close': 211.4499969482422}, {'Date': '2025-05-16', 'Close': 211.25999450683594}, {'Date': '2025-05-19', 'Close': 208.77999877929688}, {'Date': '2025-05-20', 'Close': 206.86000061035156}, {'Date': '2025-05-21', 'Close': 202.08999633789062}, {'Date': '2025-05-22', 'Close': 201.36000061035156}, {'Date': '2025-05-23', 'Close': 195.27000427246094}, {'Date': '2025-05-27', 'Close': 200.2100067138672}, {'Date': '2025-05-28', 'Close': 200.4199981689453}, {'Date': '2025-05-29', 'Close': 199.9499969482422}, {'Date': '2025-05-30', 'Close': 200.85000610351562}]}, 
                'GOOG': {'units': 6, 'data': [{'Date': '2025-04-28', 'Close': 162.4199981689453}, {'Date': '2025-04-29', 'Close': 162.05999755859375}, {'Date': '2025-04-30', 'Close': 160.88999938964844}, {'Date': '2025-05-01', 'Close': 162.7899932861328}, {'Date': '2025-05-02', 'Close': 165.80999755859375}, {'Date': '2025-05-05', 'Close': 166.0500030517578}, {'Date': '2025-05-06', 'Close': 165.1999969482422}, {'Date': '2025-05-07', 'Close': 152.8000030517578}, {'Date': '2025-05-08', 'Close': 155.75}, {'Date': '2025-05-09', 'Close': 154.3800048828125}, {'Date': '2025-05-12', 'Close': 159.5800018310547}, 
                                              {'Date': '2025-05-13', 'Close': 160.88999938964844}, {'Date': '2025-05-14', 'Close': 166.80999755859375}, {'Date': '2025-05-15', 'Close': 165.39999389648438}, {'Date': '2025-05-16', 'Close': 167.42999267578125}, {'Date': '2025-05-19', 'Close': 167.8699951171875}, {'Date': '2025-05-20', 'Close': 165.32000732421875}, {'Date': '2025-05-21', 'Close': 170.05999755859375}, {'Date': '2025-05-22', 'Close': 171.97999572753906}, {'Date': '2025-05-23', 'Close': 169.58999633789062}, {'Date': '2025-05-27', 'Close': 173.97999572753906}, {'Date': '2025-05-28', 'Close': 173.3800048828125}, {'Date': '2025-05-29', 'Close': 172.9600067138672}, {'Date': '2025-05-30', 'Close': 172.85000610351562}]}, 
                'AMZN': {'units': 3, 'data': [{'Date': '2025-04-28', 'Close': 187.6999969482422}, {'Date': '2025-04-29', 'Close': 187.38999938964844}, {'Date': '2025-04-30', 'Close': 184.4199981689453}, {'Date': '2025-05-01', 'Close': 190.1999969482422}, {'Date': '2025-05-02', 'Close': 189.97999572753906}, {'Date': '2025-05-05', 'Close': 186.35000610351562}, {'Date': '2025-05-06', 'Close': 185.00999450683594}, {'Date': '2025-05-07', 'Close': 188.7100067138672}, {'Date': '2025-05-08', 'Close': 192.0800018310547}, {'Date': '2025-05-09', 'Close': 193.05999755859375}, {'Date': '2025-05-12', 'Close': 208.63999938964844}, 
                                              {'Date': '2025-05-13', 'Close': 211.3699951171875}, {'Date': '2025-05-14', 'Close': 210.25}, {'Date': '2025-05-15', 'Close': 205.1699981689453}, {'Date': '2025-05-16', 'Close': 205.58999633789062}, {'Date': '2025-05-19', 'Close': 206.16000366210938}, {'Date': '2025-05-20', 'Close': 204.07000732421875}, {'Date': '2025-05-21', 'Close': 201.1199951171875}, {'Date': '2025-05-22', 'Close': 203.10000610351562}, {'Date': '2025-05-23', 'Close': 200.99000549316406}, {'Date': '2025-05-27', 'Close': 206.02000427246094}, {'Date': '2025-05-28', 'Close': 204.72000122070312}, {'Date': '2025-05-29', 'Close': 205.6999969482422}, {'Date': '2025-05-30', 'Close': 205.00999450683594}]}, 
                'NVDA': {'units': 9, 'data': [{'Date': '2025-04-28', 'Close': 108.7300033569336}, {'Date': '2025-04-29', 'Close': 109.0199966430664}, {'Date': '2025-04-30', 'Close': 108.91999816894531}, {'Date': '2025-05-01', 'Close': 111.61000061035156}, {'Date': '2025-05-02', 'Close': 114.5}, {'Date': '2025-05-05', 'Close': 113.81999969482422}, {'Date': '2025-05-06', 'Close': 113.54000091552734}, {'Date': '2025-05-07', 'Close': 117.05999755859375}, {'Date': '2025-05-08', 'Close': 117.37000274658203}, {'Date': '2025-05-09', 'Close': 116.6500015258789}, {'Date': '2025-05-12', 'Close': 123.0}, {'Date': '2025-05-13', 'Close': 129.92999267578125}, 
                                              {'Date': '2025-05-14', 'Close': 135.33999633789062}, {'Date': '2025-05-15', 'Close': 134.8300018310547}, {'Date': '2025-05-16', 'Close': 135.39999389648438}, {'Date': '2025-05-19', 'Close': 135.57000732421875}, {'Date': '2025-05-20', 'Close': 134.3800048828125}, {'Date': '2025-05-21', 'Close': 131.8000030517578}, {'Date': '2025-05-22', 'Close': 132.8300018310547}, {'Date': '2025-05-23', 'Close': 131.2899932861328}, {'Date': '2025-05-27', 'Close': 135.5}, {'Date': '2025-05-28', 'Close': 134.80999755859375}, {'Date': '2025-05-29', 'Close': 139.19000244140625}, {'Date': '2025-05-30', 'Close': 135.1300048828125}]}}
n_days = 20
n_simulations = 20
df_list = []
simulated_paths = pd.DataFrame()

for i, j in portfolio_data.items():
    data = pd.DataFrame(j['data'])
    data[i]=data['Close']
    df_list.append(data[[i]])

portfolio = pd.concat(df_list, axis=1)
portfolio['Value'] = portfolio.sum(axis=1)
portfolio['Ret'] = portfolio['Value'].pct_change()
portfolio = portfolio[['Value', 'Ret']][1:]

